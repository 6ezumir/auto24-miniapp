let currentStep = 1;
let answers = [];
const alex = document.getElementById("alex");
const progress = document.getElementById("progress");
const buildSound = document.getElementById("buildSound");

document.addEventListener("DOMContentLoaded", () => {
  document.querySelector(".logo").classList.add("fade-in");
  document.querySelector(".intro-text").classList.add("slide-in");
  setTimeout(() => {
    document.getElementById("step1").classList.remove("hidden");
    showAlexReaction("–ü—Ä–∏–≤–µ—Ç! –î–∞–≤–∞–π —Å–æ–±–µ—Ä–µ–º —Ç–≤–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å –º–µ—á—Ç—ã! üöó");
  }, 1000);
});

function nextStep(answer) {
  answers.push(answer);
  updateProgress();
  showAlexReaction(`–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —Ç—ã –≤—ã–±—Ä–∞–ª ${answer} ü§î`);
  document.getElementById(`step${currentStep}`).classList.add("hidden");
  currentStep++;
  document.getElementById(`step${currentStep}`).classList.remove("hidden");
}

function finishGame(budget) {
  answers.push(budget);
  updateProgress(100);
  showAlexReaction("–û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä! üöó –£–∂–µ –º–µ—á—Ç–∞—é –æ —Ç–≤–æ–µ–º –∞–≤—Ç–æ!");

  document.getElementById(`step${currentStep}`).classList.add("hidden");
  document.getElementById("final").classList.remove("hidden");

  document.getElementById("finalText").innerHTML = `
    üöó –¢—ã –≤—ã–±—Ä–∞–ª:<br>
    –ö—É–∑–æ–≤: <b>${answers[0]}</b><br>
    –°—Ç—Ä–∞–Ω–∞: <b>${answers[1]}</b><br>
    –ë—é–¥–∂–µ—Ç: <b>${answers[2]}</b>
  `;

  setTimeout(() => buildSound.play(), 600);
}

function goToBot() {
  window.location.href = "https://t.me/auto24serviceofficial_bot";
}

function showAlexReaction(text) {
  const phrases = [
    "–ö–ª–∞—Å—Å–Ω—ã–π –≤—ã–±–æ—Ä! üòé",
    "–û—Ç–ª–∏—á–Ω–æ! üöó",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! üî•",
    "–•–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç! üöÄ",
    text
  ];
  alex.textContent = "–ê–ª–µ–∫—Å: " + phrases[Math.floor(Math.random() * phrases.length)];
}

function updateProgress(forceValue) {
  const value = forceValue !== undefined ? forceValue : Math.min((answers.length / 3) * 100, 100);
  progress.style.width = `${value}%`;
}
